<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<title></title>
<meta name="Generator" content="Cocoa HTML Writer">
<meta name="CocoaVersion" content="1038.35">
<style type="text/css">
p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Monaco; color: #000000; min-height: 16.0px}
p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Monaco; color: #cd1713}
p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Monaco; color: #000000}
p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Monaco}
p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Monaco; min-height: 16.0px}
span.s1 {color: #102ac3}
span.s2 {color: #008225}
span.s3 {color: #737373}
span.s4 {color: #102ac2}
span.s5 {color: #008325}
span.s6 {color: #0f2abf}
span.Apple-tab-span {white-space:pre}
</style>
</head>
<body>
<p class="p1"><br></p>
<p class="p1"><br></p>
<p class="p2">//average</p>
<p class="p3">(</p>
<p class="p3">a = <span class="s1">MIDIMKtl</span>(<span class="s2">\nano1</span>, -1871034450);</p>
<p class="p2">// Dispatch</p>
<p class="p3">d = <span class="s1">Dispatch</span>.new;</p>
<p class="p1"><br></p>
<p class="p3">d.mapToElem( a, <span class="s2">\sl1_1</span>, <span class="s2">\myController1</span> );</p>
<p class="p3">d.mapToElem( a, <span class="s2">\sl2_1</span>, <span class="s2">\myController1</span> );</p>
<p class="p1"><br></p>
<p class="p3">d.addToProc( <span class="s2">\average</span>, { <span class="s1">|dis|</span></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="s1">var</span> val = [<span class="s2">\sl1_1</span>,<span class="s2">\sl2_1</span>].collect{ <span class="s1">|it|</span> dis.getInput( <span class="s2">\myController1</span>, it ) }.sum;</p>
<p class="p3"><span class="Apple-tab-span">	</span>dis.setOutput( <span class="s2">\average</span>, val/2 );</p>
<p class="p3">} );</p>
<p class="p1"><br></p>
<p class="p3">d.addToOutput(<span class="s2">\average</span>,<span class="s2">\blah</span>,{ |a,b,c| postln(<span class="s3">"average is "</span>++c) })</p>
<p class="p3">)</p>
<p class="p1"><br></p>
<p class="p2">//Delta</p>
<p class="p3">(</p>
<p class="p3">a = <span class="s1">MIDIMKtl</span>(<span class="s2">\nano1</span>, -1871034450);</p>
<p class="p2">// Dispatch</p>
<p class="p3">d = <span class="s1">Dispatch</span>.new;</p>
<p class="p1"><br></p>
<p class="p3">d.mapToElem( a, <span class="s2">\sl1_1</span>, <span class="s2">\myController1</span> );</p>
<p class="p3">d.mapToElem( a, <span class="s2">\sl2_1</span>, <span class="s2">\myController1</span> );</p>
<p class="p1"><br></p>
<p class="p3">d.addToProc( <span class="s2">\velocityCalc</span>, { <span class="s1">|dis,e|</span></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="s1">var</span> in = dis.changedIn;</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="s1">var</span> key = in[<span class="s2">\key</span>];</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="s1">var</span> source = in[<span class="s2">\source</span>];</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="s1">var</span> value = in[<span class="s2">\val</span>];</p>
<p class="p1"><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span>if( e[source].isNil ) {</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e.put(source,<span class="s1">Dictionary</span>.new);</p>
<p class="p3"><span class="Apple-tab-span">	</span>};</p>
<p class="p3"><span class="Apple-tab-span">	</span>if(<span class="Apple-tab-span">	</span>e[source][key].isNil ) {</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e[source][key] = value</p>
<p class="p3"><span class="Apple-tab-span">	</span>} {</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>dis.setOutput(key, value - e[source][key]);</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e[source][key] = value</p>
<p class="p3"><span class="Apple-tab-span">	</span>}</p>
<p class="p1"><br></p>
<p class="p3">} );</p>
<p class="p1"><br></p>
<p class="p3">d.addToOutput(<span class="s2">\sl1_1</span>,<span class="s2">\blah</span>,{ |a,b,c| postln(<span class="s3">"delta is "</span>++c) })</p>
<p class="p3">)</p>
<p class="p1"><br></p>
<p class="p2">//Velocity</p>
<p class="p4">(</p>
<p class="p4">a = <span class="s4">MIDIMKtl</span>(<span class="s5">\nano1</span>, -1871034450);</p>
<p class="p2">// Dispatch</p>
<p class="p4">d = <span class="s4">Dispatch</span>.new;</p>
<p class="p5"><br></p>
<p class="p4">d.mapToElem( a, <span class="s5">\sl1_1</span>, <span class="s5">\myController1</span> );</p>
<p class="p4">d.mapToElem( a, <span class="s5">\sl2_1</span>, <span class="s5">\myController1</span> );</p>
<p class="p5"><br></p>
<p class="p4">d.addToProc( <span class="s5">\velocityCalc</span>, { <span class="s4">|dis,e|</span></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="s4">var</span> in = dis.changedIn;</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="s4">var</span> key = in[<span class="s5">\key</span>];</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="s4">var</span> source = in[<span class="s5">\source</span>];</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="s4">var</span> value = in[<span class="s5">\val</span>];</p>
<p class="p4"><span class="Apple-tab-span">	</span>var keyTime = (key++"time").asSymbol;</p>
<p class="p4"><span class="Apple-tab-span">	</span>var currentTime;</p>
<p class="p5"><span class="Apple-tab-span">	</span></p>
<p class="p4"><span class="Apple-tab-span">	</span>if( e[source].isNil ) {</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e.put(source,<span class="s4">Dictionary</span>.new);</p>
<p class="p4"><span class="Apple-tab-span">	</span>};</p>
<p class="p4"><span class="Apple-tab-span">	</span>if(<span class="Apple-tab-span">	</span>e[source][key].isNil ) {</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e[source][key] = value;</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e[source][keyTime] = Process.elapsedTime;</p>
<p class="p4"><span class="Apple-tab-span">	</span>} {</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>currentTime = Process.elapsedTime;</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>dis.setOutput(key, abs( (value - e[source][key]) / ( currentTime - e[source][keyTime] ) ) ) ;</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e[source][key] = value;</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e[source][keyTime] = currentTime;</p>
<p class="p4"><span class="Apple-tab-span">	</span>}</p>
<p class="p5"><br></p>
<p class="p4">} );</p>
<p class="p5"><br></p>
<p class="p4">w = <span class="s6">Window</span>.new.front;</p>
<p class="p4">~sl = <span class="s6">Slider</span>(w, <span class="s6">Rect</span>(20, 60, 150, 20));</p>
<p class="p4">d.addToOutput(<span class="s5">\sl1_1</span>,<span class="s5">\blah</span>,{ |a,b,c| { ~sl.value_(c/4000) }.defer; x.set(\freq,c*2)<span class="Apple-converted-space">  </span>});</p>
<p class="p4">d.addToOutput(<span class="s5">\sl2_1</span>,<span class="s5">\blah</span>,{ |a,b,c| { ~sl.value_(c/4000) }.defer; x.set(\mod, c/40)<span class="Apple-converted-space">  </span>})</p>
<p class="p5"><br></p>
<p class="p4">)</p>
<p class="p4">x = { |freq= 400, mod = 1| Saw.ar( Lag.kr(freq) ) * SinOsc.ar(Lag.kr(mod) ).range(0.0,1.0)* 0.5 }.play</p>
<p class="p5"><br></p>
<p class="p4">x = { |freq= 400, mod = 1| Saw.ar( LeakDC.kr( Lag.kr(freq)) + 100 ) * SinOsc.ar( LeakDC.kr( Lag.kr(mod), 0.990) + 1 ).range(0.0,1.0)* 0.5 }.play</p>
<p class="p1"><br></p>
</body>
</html>
